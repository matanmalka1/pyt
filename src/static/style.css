*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --green:#1a3a2a;--lime:#b8f07a;--cream:#f5f0e8;
  --rust:#c94f2a;--tan:#d4c4a8;--dark:#0e1f16;--muted:#6b7c6b;
  --card:rgba(26,58,42,0.45);--border:rgba(184,240,122,0.12);
  --warn:#f0c84a;
}
html{scroll-behavior:smooth}
body{background:var(--dark);color:var(--cream);font-family:'Fraunces',Georgia,serif;font-size:16px;line-height:1.6;min-height:100vh}

body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");pointer-events:none;z-index:999;opacity:.35}

.shell{display:grid;grid-template-columns:260px 1fr;min-height:100vh}

/* ── SIDEBAR ── */
.sidebar{background:rgba(14,31,22,.95);border-left:1px solid var(--border);padding:2rem 1.5rem;display:flex;flex-direction:column;gap:2rem;position:sticky;top:0;height:100vh;overflow-y:auto}
.logo{font-family:'DM Mono',monospace;font-size:.75rem;color:var(--lime);letter-spacing:.2em;text-transform:uppercase}
.logo span{display:block;font-size:1.6rem;font-family:'Fraunces',serif;font-weight:700;letter-spacing:-.02em;color:var(--cream);margin-top:.25rem}
.nav-item{display:flex;align-items:center;gap:.75rem;padding:.6rem .9rem;border-radius:8px;cursor:pointer;font-family:'DM Mono',monospace;font-size:.78rem;color:var(--muted);transition:all .2s;border:1px solid transparent}
.nav-item:hover{color:var(--cream);background:var(--card)}
.nav-item.active{color:var(--lime);background:rgba(184,240,122,.08);border-color:var(--border)}
.nav-dot{width:6px;height:6px;border-radius:50%;background:currentColor;flex-shrink:0}
.sidebar-status{margin-top:auto;padding:1rem;background:var(--card);border-radius:10px;border:1px solid var(--border)}
.status-label{font-family:'DM Mono',monospace;font-size:.65rem;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-bottom:.4rem}
.status-val{font-size:.9rem;color:var(--cream)}
.status-val.good{color:var(--lime)}
.status-val.bad{color:var(--rust)}

/* ── MAIN ── */
.main{padding:2.5rem 3rem;display:flex;flex-direction:column;gap:2rem}
.page{display:none}
.page.active{display:flex;flex-direction:column;gap:1.5rem}
.page-header{border-bottom:1px solid var(--border);padding-bottom:1.25rem}
.page-title{font-size:2rem;font-weight:700;letter-spacing:-.02em}
.page-sub{font-size:.9rem;color:var(--tan);font-weight:300;margin-top:.25rem}

/* ── CARDS ── */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:1.5rem}
.card-title{font-family:'DM Mono',monospace;font-size:.7rem;letter-spacing:.15em;color:var(--lime);text-transform:uppercase;margin-bottom:1rem}

/* ── FORM ── */
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
.field{display:flex;flex-direction:column;gap:.4rem}
.field label{font-family:'DM Mono',monospace;font-size:.7rem;color:var(--muted);letter-spacing:.08em;text-transform:uppercase}
.field input,.field select{background:rgba(0,0,0,.3);border:1px solid var(--border);border-radius:7px;padding:.55rem .85rem;color:var(--cream);font-family:'DM Mono',monospace;font-size:.85rem;outline:none;transition:border-color .2s;width:100%}
.field input:focus,.field select:focus{border-color:rgba(184,240,122,.4)}
.field select option{background:#1a3a2a}

/* ── BUTTONS ── */
.btn{font-family:'DM Mono',monospace;font-size:.8rem;letter-spacing:.08em;padding:.65rem 1.4rem;border-radius:8px;border:none;cursor:pointer;transition:all .2s;text-transform:uppercase}
.btn-primary{background:var(--lime);color:var(--dark);font-weight:500}
.btn-primary:hover{background:#ceff8a;transform:translateY(-1px)}
.btn-primary:disabled{opacity:.4;cursor:not-allowed;transform:none}
.btn-ghost{background:transparent;color:var(--muted);border:1px solid var(--border)}
.btn-ghost:hover{color:var(--cream);border-color:rgba(184,240,122,.3)}

/* ── LOG ── */
.log-box{background:rgba(0,0,0,.4);border:1px solid var(--border);border-radius:10px;padding:1rem 1.2rem;height:220px;overflow-y:auto;font-family:'DM Mono',monospace;font-size:.75rem;line-height:1.7}
.log-line{color:var(--tan)}
.log-line.epoch{color:var(--lime);font-weight:500}
.log-line.result{color:var(--cream)}
.log-line.err{color:var(--rust)}
.log-line.done{color:var(--lime);font-weight:700}

/* ── PROGRESS ── */
.epoch-progress{display:flex;flex-direction:column;gap:.5rem}
.ep-row{display:flex;align-items:center;gap:.75rem;font-family:'DM Mono',monospace;font-size:.75rem}
.ep-label{color:var(--muted);width:80px;flex-shrink:0}
.ep-bar-wrap{flex:1;height:6px;background:rgba(255,255,255,.06);border-radius:3px;overflow:hidden}
.ep-bar{height:100%;background:var(--lime);border-radius:3px;transition:width .4s ease;width:0%}
.ep-val{color:var(--cream);width:55px;text-align:left;flex-shrink:0}

/* ── STATS ── */
.stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem}
.stat-card{background:rgba(0,0,0,.2);border:1px solid var(--border);border-radius:10px;padding:1rem;text-align:center}
.stat-num{font-size:1.6rem;font-weight:700;color:var(--lime);font-family:'Fraunces',serif}
.stat-lbl{font-family:'DM Mono',monospace;font-size:.65rem;color:var(--muted);letter-spacing:.08em;text-transform:uppercase;margin-top:.2rem}
.chart-wrap{position:relative;height:260px}

/* ── UPLOAD ZONE ── */
.upload-zone{border:2px dashed var(--border);border-radius:14px;padding:2rem;text-align:center;cursor:pointer;transition:all .3s;position:relative;overflow:hidden}
.upload-zone:hover,.upload-zone.drag{border-color:rgba(184,240,122,.5);background:rgba(184,240,122,.04)}
.upload-zone input[type=file]{position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%}
.upload-icon{font-size:2.5rem;margin-bottom:.75rem}
.upload-text{color:var(--tan);font-weight:300}
.upload-hint{font-family:'DM Mono',monospace;font-size:.7rem;color:var(--muted);margin-top:.4rem}

/* ── [NEW] IMAGE PREVIEW in upload zone ── */
.preview-wrap{position:relative;display:inline-block}
.preview-img-thumb{width:160px;height:160px;object-fit:cover;border-radius:10px;border:2px solid rgba(184,240,122,.3);display:block;margin:0 auto .75rem}
.btn-clear{position:absolute;top:-8px;right:-8px;width:24px;height:24px;border-radius:50%;background:var(--rust);border:none;cursor:pointer;color:white;font-size:.8rem;display:flex;align-items:center;justify-content:center;line-height:1;transition:transform .2s}
.btn-clear:hover{transform:scale(1.15)}

/* ── PREDICT RESULT ── */
.predict-result{display:grid;grid-template-columns:auto 1fr;gap:1.5rem;align-items:start}
.predict-img{width:180px;height:180px;object-fit:cover;border-radius:10px;border:1px solid var(--border)}

/* ── GRAD-CAM ── */
.gradcam-wrap{display:grid;grid-template-columns:1fr 1fr;gap:1.25rem;margin-top:1.25rem;padding-top:1.25rem;border-top:1px solid var(--border)}
.gradcam-col{display:flex;flex-direction:column;align-items:center;gap:.5rem}
.gradcam-img{width:100%;max-width:280px;height:230px;object-fit:cover;border-radius:10px;border:1px solid var(--border);transition:transform .25s}
.gradcam-img:hover{transform:scale(1.04)}
.gradcam-label{font-family:'DM Mono',monospace;font-size:.65rem;color:var(--muted);letter-spacing:.12em;text-transform:uppercase}
.gradcam-legend{display:flex;flex-direction:column;align-items:center;gap:.2rem;margin-top:.2rem}
.gradcam-legend-bar{height:5px;width:110px;border-radius:3px;background:linear-gradient(to right,#3b6fd4,#31a354,#d62728)}
.gradcam-legend-labels{display:flex;justify-content:space-between;width:110px;font-family:'DM Mono',monospace;font-size:.58rem;color:var(--muted)}
.gradcam-error{font-family:'DM Mono',monospace;font-size:.72rem;color:var(--muted);text-align:center;padding:.75rem}

/* [NEW] HEALTH BADGE */
.health-badge{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;border-radius:8px;font-family:'DM Mono',monospace;font-size:.8rem;font-weight:500;letter-spacing:.06em;text-transform:uppercase;margin-bottom:1rem;animation:badgeIn .4s ease forwards}
.health-badge.healthy{background:rgba(184,240,122,.15);border:1px solid rgba(184,240,122,.4);color:var(--lime)}
.health-badge.sick{background:rgba(201,79,42,.15);border:1px solid rgba(201,79,42,.4);color:var(--rust)}
.health-badge.warn{background:rgba(240,200,74,.15);border:1px solid rgba(240,200,74,.4);color:var(--warn)}
@keyframes badgeIn{from{opacity:0;transform:translateY(-6px)}to{opacity:1;transform:translateY(0)}}

/* PREDICTIONS LIST */
.predictions{display:flex;flex-direction:column;gap:.6rem;width:100%}
.pred-row{display:flex;align-items:center;gap:.75rem}
.pred-rank{font-family:'DM Mono',monospace;font-size:.7rem;color:var(--muted);width:20px;flex-shrink:0}
.pred-bar-wrap{flex:1;height:28px;background:rgba(0,0,0,.2);border-radius:6px;overflow:hidden;position:relative}
.pred-bar{height:100%;border-radius:6px;transition:width .6s ease}
.pred-bar.conf-high{background:linear-gradient(90deg,rgba(184,240,122,.55),rgba(184,240,122,.2))}
.pred-bar.conf-mid {background:linear-gradient(90deg,rgba(240,200,74,.45),rgba(240,200,74,.15))}
.pred-bar.conf-low {background:linear-gradient(90deg,rgba(201,79,42,.45),rgba(201,79,42,.15))}
.pred-label{position:absolute;inset:0;display:flex;align-items:center;padding:0 .75rem;font-family:'DM Mono',monospace;font-size:.72rem;color:var(--cream)}
.pred-pct{font-family:'DM Mono',monospace;font-size:.75rem;width:50px;text-align:left;flex-shrink:0}
.pred-pct.conf-high{color:var(--lime);font-weight:500}
.pred-pct.conf-mid {color:var(--warn)}
.pred-pct.conf-low {color:var(--rust)}

/* ── [NEW] HISTORY ── */
.history-list{display:flex;flex-direction:column;gap:.6rem;max-height:320px;overflow-y:auto}
.history-item{display:flex;align-items:center;gap:1rem;padding:.65rem .9rem;background:rgba(0,0,0,.25);border:1px solid var(--border);border-radius:9px;cursor:pointer;transition:all .2s}
.history-item:hover{border-color:rgba(184,240,122,.3);background:rgba(26,58,42,.5)}
.history-thumb{width:44px;height:44px;object-fit:cover;border-radius:6px;flex-shrink:0}
.history-info{flex:1;min-width:0}
.history-label{font-family:'DM Mono',monospace;font-size:.75rem;color:var(--cream);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.history-meta{font-family:'DM Mono',monospace;font-size:.65rem;color:var(--muted);margin-top:.15rem}
.history-badge{font-family:'DM Mono',monospace;font-size:.65rem;padding:.2rem .5rem;border-radius:4px;flex-shrink:0}
.history-badge.healthy{background:rgba(184,240,122,.15);color:var(--lime);border:1px solid rgba(184,240,122,.3)}
.history-badge.sick{background:rgba(201,79,42,.15);color:var(--rust);border:1px solid rgba(201,79,42,.3)}
.history-empty{font-family:'DM Mono',monospace;font-size:.8rem;color:var(--muted);text-align:center;padding:2rem}

/* ── MISC ── */
.hidden{display:none}
.spinner{display:inline-block;width:14px;height:14px;border:2px solid rgba(14,31,22,.4);border-top-color:var(--dark);border-radius:50%;animation:spin .7s linear infinite;vertical-align:middle;margin-left:.5rem}
@keyframes spin{to{transform:rotate(360deg)}}
::-webkit-scrollbar{width:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--green);border-radius:3px}

/* ── MODEL COMPARISON TABLE ── */
.compare-table{width:100%;border-collapse:collapse;font-family:'DM Mono',monospace;font-size:.78rem;margin-top:.5rem}
.compare-table th{text-align:right;padding:.6rem 1rem;color:var(--muted);font-size:.65rem;letter-spacing:.1em;text-transform:uppercase;border-bottom:1px solid var(--border)}
.compare-table td{padding:.75rem 1rem;border-bottom:1px solid rgba(255,255,255,.04);color:var(--cream);vertical-align:middle}
.compare-table tr:hover td{background:rgba(184,240,122,.03)}
.compare-table .best-row td{color:var(--lime)}
.mini-bar-wrap{display:flex;align-items:center;gap:.5rem}
.mini-bar{height:5px;border-radius:3px;background:var(--lime);opacity:.8}
